(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const Pt=new Navigo("/");window.addEventListener("load",()=>{Pt.on("/:company/:routeId",function({data:t}){Ve({company:t.company,routeId:t.routeId})}).on("/:company/:route/:param1",function({data:t}){let e={};t.company==="mtr_hr"?(e.routeId=t.route,e.stop=t.param1):t.company==="nlb"?(e.route=t.route,e.routeId=t.param1):(e.route=t.route,e.dir=t.param1),Ve({company:t.company,...e})}).on("/:company/:route/:param1/:stop",function({data:t}){let e={};t.company==="nlb"?(e.routeId=t.param1,e.stop=t.stop):t.company==="gmb"?(e.routeId=t.param1,e.routeType=t.stop):(e.dir=t.param1,e.stop=t.stop),Ve({company:t.company,route:t.route,...e})}).on("/:company/:route/:routeId/:routeType/:stop",function({data:t}){Ve({company:t.company,route:t.route,routeId:t.routeId,routeType:t.routeType,stop:t.stop})}).on("/search",function({path:t,params:e}){document.getElementById("routeInput").value=e.q,document.getElementById("btnSearch").click()}).resolve()});function Ve(t){fetch(ROUTE_API.replace("{route}",t.company==="mtr_hr"?t.company:t.route)).then(e=>e.json()).then(e=>{const n=e.filter(r=>r.company===(t.company==="nwfb"?"ctb":t.company)&&(t.dir?r.dir===t.dir:!0)&&(t.routeId?r.routeId===t.routeId||r.routeId===parseInt(t.routeId):!0)&&(t.routeType?r.routeType===parseInt(t.routeType):!0));if(!n){alert(`Cannot find route ${t.route} !`,"danger");return}renderRoute(n[0]),t.stop&&triggerStopClick(t.company==="gmb"?parseInt(t.stop):t.stop)}).catch(function(e){console.log(e),alert(`Cannot find route ${t.route} !`,"danger")})}function yr(t,e=!1){return t.company==="mtr_hr"?`/${t.company}/${t.routeId}${e?"/"+t.stop:""}`:t.company==="nlb"?`/${t.company}/${t.route}/${t.routeId}${e?"/"+t.stop:""}`:t.company==="gmb"?`/${t.company}/${t.route}/${t.routeId}/${t.routeType}${e?"/"+t.stop:""}`:`/${t.company}/${t.route}/${t.dir}${e?"/"+t.stop:""}`}function _r(){Pt.updatePageLinks()}function wr(t){Pt.navigate(t)}window.reloadRouter=_r;window.getRouteUrl=yr;window.routeNavigate=wr;/*!
 * Color mode toggler for Bootstrap's docs (https://getbootstrap.com/)
 * Copyright 2011-2023 The Bootstrap Authors
 * Licensed under the Creative Commons Attribution 3.0 Unported License.
 */(()=>{const t=()=>localStorage.getItem("theme"),e=i=>localStorage.setItem("theme",i),n=()=>{const i=t();return i||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},r=i=>{i==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.setAttribute("data-bs-theme","dark"):document.documentElement.setAttribute("data-bs-theme",i)};r(n());const o=(i,a=!1)=>{const s=document.querySelector("#bd-theme");if(!s)return;const l=document.querySelector("#bd-theme-text"),c=document.querySelector(".theme-icon-active use"),d=document.querySelector(`[data-bs-theme-value="${i}"]`),f=d.querySelector("svg use").getAttribute("href");document.querySelectorAll("[data-bs-theme-value]").forEach(m=>{m.classList.remove("active"),m.setAttribute("aria-pressed","false")}),d.classList.add("active"),d.setAttribute("aria-pressed","true"),c.setAttribute("href",f);const h=`${l.textContent} (${d.dataset.bsThemeValue})`;s.setAttribute("aria-label",h),a&&s.focus()};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const i=t();i!=="light"&&i!=="dark"&&r(n())}),window.addEventListener("DOMContentLoaded",()=>{o(n()),document.querySelectorAll("[data-bs-theme-value]").forEach(i=>{i.addEventListener("click",()=>{const a=i.getAttribute("data-bs-theme-value");e(a),r(a),o(a,!0)})})})})();const ae=new Map,ut={set(t,e,n){ae.has(t)||ae.set(t,new Map);const r=ae.get(t);if(!r.has(e)&&r.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`);return}r.set(e,n)},get(t,e){return ae.has(t)&&ae.get(t).get(e)||null},remove(t,e){if(!ae.has(t))return;const n=ae.get(t);n.delete(e),n.size===0&&ae.delete(t)}},Sr=1e3,Dt="transitionend",Cn=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(e,n)=>`#${CSS.escape(n)}`)),t),Ar=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),Tr=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:n}=window.getComputedStyle(t);const r=Number.parseFloat(e),o=Number.parseFloat(n);return!r&&!o?0:(e=e.split(",")[0],n=n.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(n))*Sr)},Cr=t=>{t.dispatchEvent(new Event(Dt))},Se=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),kt=t=>Se(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(Cn(t)):null,Mt=t=>{if(!Se(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",n=t.closest("details:not([open])");if(!n)return e;if(n!==t){const r=t.closest("summary");if(r&&r.parentNode!==n||r===null)return!1}return e},Rt=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",Dn=t=>{t.offsetHeight},kn=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,dt=[],Dr=t=>{document.readyState==="loading"?(dt.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of dt)e()}),dt.push(t)):t()},Qt=()=>document.documentElement.dir==="rtl",In=t=>{Dr(()=>{const e=kn();if(e){const n=t.NAME,r=e.fn[n];e.fn[n]=t.jQueryInterface,e.fn[n].Constructor=t,e.fn[n].noConflict=()=>(e.fn[n]=r,t.jQueryInterface)}})},be=(t,e=[],n=t)=>typeof t=="function"?t(...e):n,On=(t,e,n=!0)=>{if(!n){be(t);return}const o=Tr(e)+5;let i=!1;const a=({target:s})=>{s===e&&(i=!0,e.removeEventListener(Dt,a),be(t))};e.addEventListener(Dt,a),setTimeout(()=>{i||Cr(e)},o)},kr=/[^.]*(?=\..*)\.|.*/,Ir=/\..*/,Or=/::\d+$/,ft={};let Zt=1;const Nn={mouseenter:"mouseover",mouseleave:"mouseout"},Nr=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ln(t,e){return e&&`${e}::${Zt++}`||t.uidEvent||Zt++}function Fn(t){const e=Ln(t);return t.uidEvent=e,ft[e]=ft[e]||{},ft[e]}function Lr(t,e){return function n(r){return xt(r,{delegateTarget:t}),n.oneOff&&y.off(t,r.type,e),e.apply(t,[r])}}function Fr(t,e,n){return function r(o){const i=t.querySelectorAll(e);for(let{target:a}=o;a&&a!==this;a=a.parentNode)for(const s of i)if(s===a)return xt(o,{delegateTarget:a}),r.oneOff&&y.off(t,o.type,e,n),n.apply(a,[o])}}function Bn(t,e,n=null){return Object.values(t).find(r=>r.callable===e&&r.delegationSelector===n)}function $n(t,e,n){const r=typeof e=="string",o=r?n:e||n;let i=Pn(t);return Nr.has(i)||(i=t),[r,o,i]}function jt(t,e,n,r,o){if(typeof e!="string"||!t)return;let[i,a,s]=$n(e,n,r);e in Nn&&(a=(b=>function(v){if(!v.relatedTarget||v.relatedTarget!==v.delegateTarget&&!v.delegateTarget.contains(v.relatedTarget))return b.call(this,v)})(a));const l=Fn(t),c=l[s]||(l[s]={}),d=Bn(c,a,i?n:null);if(d){d.oneOff=d.oneOff&&o;return}const f=Ln(a,e.replace(kr,"")),h=i?Fr(t,n,a):Lr(t,a);h.delegationSelector=i?n:null,h.callable=a,h.oneOff=o,h.uidEvent=f,c[f]=h,t.addEventListener(s,h,i)}function It(t,e,n,r,o){const i=Bn(e[n],r,o);i&&(t.removeEventListener(n,i,!!o),delete e[n][i.uidEvent])}function Br(t,e,n,r){const o=e[n]||{};for(const[i,a]of Object.entries(o))i.includes(r)&&It(t,e,n,a.callable,a.delegationSelector)}function Pn(t){return t=t.replace(Ir,""),Nn[t]||t}const y={on(t,e,n,r){jt(t,e,n,r,!1)},one(t,e,n,r){jt(t,e,n,r,!0)},off(t,e,n,r){if(typeof e!="string"||!t)return;const[o,i,a]=$n(e,n,r),s=a!==e,l=Fn(t),c=l[a]||{},d=e.startsWith(".");if(typeof i<"u"){if(!Object.keys(c).length)return;It(t,l,a,i,o?n:null);return}if(d)for(const f of Object.keys(l))Br(t,l,f,e.slice(1));for(const[f,h]of Object.entries(c)){const m=f.replace(Or,"");(!s||e.includes(m))&&It(t,l,a,h.callable,h.delegationSelector)}},trigger(t,e,n){if(typeof e!="string"||!t)return null;const r=kn(),o=Pn(e),i=e!==o;let a=null,s=!0,l=!0,c=!1;i&&r&&(a=r.Event(e,n),r(t).trigger(a),s=!a.isPropagationStopped(),l=!a.isImmediatePropagationStopped(),c=a.isDefaultPrevented());const d=xt(new Event(e,{bubbles:s,cancelable:!0}),n);return c&&d.preventDefault(),l&&t.dispatchEvent(d),d.defaultPrevented&&a&&a.preventDefault(),d}};function xt(t,e={}){for(const[n,r]of Object.entries(e))try{t[n]=r}catch{Object.defineProperty(t,n,{configurable:!0,get(){return r}})}return t}function en(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function ht(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const $e={setDataAttribute(t,e,n){t.setAttribute(`data-bs-${ht(e)}`,n)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${ht(e)}`)},getDataAttributes(t){if(!t)return{};const e={},n=Object.keys(t.dataset).filter(r=>r.startsWith("bs")&&!r.startsWith("bsConfig"));for(const r of n){let o=r.replace(/^bs/,"");o=o.charAt(0).toLowerCase()+o.slice(1,o.length),e[o]=en(t.dataset[r])}return e},getDataAttribute(t,e){return en(t.getAttribute(`data-bs-${ht(e)}`))}};class Ht{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,n){const r=Se(n)?$e.getDataAttribute(n,"config"):{};return{...this.constructor.Default,...typeof r=="object"?r:{},...Se(n)?$e.getDataAttributes(n):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,n=this.constructor.DefaultType){for(const[r,o]of Object.entries(n)){const i=e[r],a=Se(i)?"element":Ar(i);if(!new RegExp(o).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${r}" provided type "${a}" but expected type "${o}".`)}}}const $r="5.3.3";class Mn extends Ht{constructor(e,n){super(),e=kt(e),e&&(this._element=e,this._config=this._getConfig(n),ut.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ut.remove(this._element,this.constructor.DATA_KEY),y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,n,r=!0){On(e,n,r)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ut.get(kt(e),this.DATA_KEY)}static getOrCreateInstance(e,n={}){return this.getInstance(e)||new this(e,typeof n=="object"?n:null)}static get VERSION(){return $r}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const mt=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let n=t.getAttribute("href");if(!n||!n.includes("#")&&!n.startsWith("."))return null;n.includes("#")&&!n.startsWith("#")&&(n=`#${n.split("#")[1]}`),e=n&&n!=="#"?n.trim():null}return e?e.split(",").map(n=>Cn(n)).join(","):null},B={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(n=>n.matches(e))},parents(t,e){const n=[];let r=t.parentNode.closest(e);for(;r;)n.push(r),r=r.parentNode.closest(e);return n},prev(t,e){let n=t.previousElementSibling;for(;n;){if(n.matches(e))return[n];n=n.previousElementSibling}return[]},next(t,e){let n=t.nextElementSibling;for(;n;){if(n.matches(e))return[n];n=n.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(n=>`${n}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(n=>!Rt(n)&&Mt(n))},getSelectorFromElement(t){const e=mt(t);return e&&B.findOne(e)?e:null},getElementFromSelector(t){const e=mt(t);return e?B.findOne(e):null},getMultipleElementsFromSelector(t){const e=mt(t);return e?B.find(e):[]}},Rn="backdrop",Pr="fade",tn="show",nn=`mousedown.bs.${Rn}`,Mr={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Rr={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class xn extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Mr}static get DefaultType(){return Rr}static get NAME(){return Rn}show(e){if(!this._config.isVisible){be(e);return}this._append();const n=this._getElement();this._config.isAnimated&&Dn(n),n.classList.add(tn),this._emulateAnimation(()=>{be(e)})}hide(e){if(!this._config.isVisible){be(e);return}this._getElement().classList.remove(tn),this._emulateAnimation(()=>{this.dispose(),be(e)})}dispose(){this._isAppended&&(y.off(this._element,nn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Pr),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=kt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),y.on(e,nn,()=>{be(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){On(e,this._getElement(),this._config.isAnimated)}}const Hn=(t,e="hide")=>{const n=`click.dismiss${t.EVENT_KEY}`,r=t.NAME;y.on(document,n,`[data-bs-dismiss="${r}"]`,function(o){if(["A","AREA"].includes(this.tagName)&&o.preventDefault(),Rt(this))return;const i=B.getElementFromSelector(this)||this.closest(`.${r}`);t.getOrCreateInstance(i)[e]()})},xr="focustrap",Hr="bs.focustrap",nt=`.${Hr}`,Wr=`focusin${nt}`,Kr=`keydown.tab${nt}`,Yr="Tab",Ur="forward",rn="backward",Vr={autofocus:!0,trapElement:null},Gr={autofocus:"boolean",trapElement:"element"};class Wn extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Vr}static get DefaultType(){return Gr}static get NAME(){return xr}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),y.off(document,nt),y.on(document,Wr,e=>this._handleFocusin(e)),y.on(document,Kr,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,y.off(document,nt))}_handleFocusin(e){const{trapElement:n}=this._config;if(e.target===document||e.target===n||n.contains(e.target))return;const r=B.focusableChildren(n);r.length===0?n.focus():this._lastTabNavDirection===rn?r[r.length-1].focus():r[0].focus()}_handleKeydown(e){e.key===Yr&&(this._lastTabNavDirection=e.shiftKey?rn:Ur)}}const on=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",an=".sticky-top",Ge="padding-right",sn="margin-right";class Ot{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ge,n=>n+e),this._setElementAttributes(on,Ge,n=>n+e),this._setElementAttributes(an,sn,n=>n-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ge),this._resetElementAttributes(on,Ge),this._resetElementAttributes(an,sn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,n,r){const o=this.getWidth(),i=a=>{if(a!==this._element&&window.innerWidth>a.clientWidth+o)return;this._saveInitialAttribute(a,n);const s=window.getComputedStyle(a).getPropertyValue(n);a.style.setProperty(n,`${r(Number.parseFloat(s))}px`)};this._applyManipulationCallback(e,i)}_saveInitialAttribute(e,n){const r=e.style.getPropertyValue(n);r&&$e.setDataAttribute(e,n,r)}_resetElementAttributes(e,n){const r=o=>{const i=$e.getDataAttribute(o,n);if(i===null){o.style.removeProperty(n);return}$e.removeDataAttribute(o,n),o.style.setProperty(n,i)};this._applyManipulationCallback(e,r)}_applyManipulationCallback(e,n){if(Se(e)){n(e);return}for(const r of B.find(e,this._element))n(r)}}const qr="offcanvas",zr="bs.offcanvas",ne=`.${zr}`,Kn=".data-api",Xr=`load${ne}${Kn}`,Jr="Escape",ln="show",cn="showing",un="hiding",Qr="offcanvas-backdrop",Yn=".offcanvas.show",Zr=`show${ne}`,jr=`shown${ne}`,eo=`hide${ne}`,dn=`hidePrevented${ne}`,Un=`hidden${ne}`,to=`resize${ne}`,no=`click${ne}${Kn}`,ro=`keydown.dismiss${ne}`,oo='[data-bs-toggle="offcanvas"]',io={backdrop:!0,keyboard:!0,scroll:!1},ao={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ee extends Mn{constructor(e,n){super(e,n),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return io}static get DefaultType(){return ao}static get NAME(){return qr}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||y.trigger(this._element,Zr,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Ot().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(cn);const r=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(ln),this._element.classList.remove(cn),y.trigger(this._element,jr,{relatedTarget:e})};this._queueCallback(r,this._element,!0)}hide(){if(!this._isShown||y.trigger(this._element,eo).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(un),this._backdrop.hide();const n=()=>{this._element.classList.remove(ln,un),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Ot().reset(),y.trigger(this._element,Un)};this._queueCallback(n,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){y.trigger(this._element,dn);return}this.hide()},n=!!this._config.backdrop;return new xn({className:Qr,isVisible:n,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:n?e:null})}_initializeFocusTrap(){return new Wn({trapElement:this._element})}_addEventListeners(){y.on(this._element,ro,e=>{if(e.key===Jr){if(this._config.keyboard){this.hide();return}y.trigger(this._element,dn)}})}static jQueryInterface(e){return this.each(function(){const n=ee.getOrCreateInstance(this,e);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}y.on(document,no,oo,function(t){const e=B.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),Rt(this))return;y.one(e,Un,()=>{Mt(this)&&this.focus()});const n=B.findOne(Yn);n&&n!==e&&ee.getInstance(n).hide(),ee.getOrCreateInstance(e).toggle(this)});y.on(window,Xr,()=>{for(const t of B.find(Yn))ee.getOrCreateInstance(t).show()});y.on(window,to,()=>{for(const t of B.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&ee.getOrCreateInstance(t).hide()});Hn(ee);In(ee);function Vn(t){return window.btoa(encodeURIComponent(t))}function Gn(t){return decodeURIComponent(window.atob(t))}function rt(t){return t==="mtr_hr"&&(t="mtr"),`/img/${t}.svg`}function z(t,e={}){let n=document.createElement("template"),r=document.querySelector(`template#${t}`).innerHTML;for(let o in e)r=r.replaceAll(o,e[o]);return n.innerHTML=r.trim(),n.content.firstChild}function fn(t){switch(t){case"kmb":return"‰πùÂ∑¥";case"ctb":return"ÂüéÂ∑¥";case"nwfb":return"Êñ∞Â∑¥";case"nlb":return"Êñ∞Â§ßÂ∂ºÂ±±Â∑¥Â£´";case"gmb":return"Â∞èÂ∑¥";case"mtr":return"Âú∞ÈêµÂ∑¥Â£´";case"mtr-hr":return"Âú∞Èêµ";case"mtr-lr":return"ËºïÈêµ";default:return""}}function Nt(t,e=!1){switch(t){case"kmb":return e?"#FFFFFF":"#FF0000";case"ctb":return e?"#0080FF":"#F9BF00";case"nwfb":return e?"#7000CC":"#EF7925";case"nlb":return e?"#3DC9B4":"#2A897B";case"gmb":return e?"#53B776":"#337149";case"mtr":return e?"#53B776":"#1A81FF"}return"#000"}function x(t,e){if(t==="route-hr")switch(e){case"TWL":return"#ff0000";case"KTL":return"#1a9431";case"ISL":return"#0860a8";case"SIL":return"#b5bd00";case"TKL":return"#6b208b";case"AEL":return"#1c7670";case"TCL":return"#fe7f1d";case"DRL":return"#f550a6";case"EAL":return"#5eb6e4";case"TML":return"#9a3b26"}else if(t==="station-hr")switch(e){case"CEN":return"#AA0000";case"ADM":return"#3A86D4";case"TST":return"#FFEF00";case"JOR":return"#69B72B";case"YMT":return"#CCCCCC";case"MOK":return"#BE2700";case"PRE":return"#8674A1";case"SSP":return"#016258";case"CSW":return"#B5A265";case"LCK":return"#E04300";case"MEF":return"#1E90FF";case"LAK":return"#BB2200";case"KWF":return"#233D3A";case"KWH":return"#F1CC00";case"TWH":return"#A2B741";case"TSW":return"#BB2200";case"WHA":return"#AECFF0";case"HOM":return"#A2CF5A";case"SKM":return"#669933";case"KOT":return"#007FFF";case"LOF":return"#579E2F";case"WTS":return"#FFFF00";case"DIH":return"#000000";case"CHH":return"#27408B";case"KOB":return"#C80815";case"NTK":return"#92B6A3";case"KWT":return"#FFFFFF";case"LAT":return"#0083BE";case"YAT":return"#FFEF00";case"TIK":return"#DCD144";case"KET":return"#95D0D0";case"HKU":return"#B8DA89";case"SYP":return"#8B7BA0";case"SHW":return"#FFD280";case"WAC":return"#E1EB2B";case"CAB":return"#C8A2C8";case"TIH":return"#FF7D00";case"FOH":return"#4B8842";case"NOP":return"#E86220";case"QUB":return"#00918C";case"TAK":return"#BB2200";case"SWH":return"#FFCC00";case"SKW":return"#191970";case"HFC":return"#C01204";case"CHW":return"#38510E";case"TKO":return"#E60012";case"HAH":return"#2EA9DF";case"POA":return"#F28500";case"LHP":return"#826F79";case"HOK":return"#FFFAFA";case"KOW":return"#ACA28A";case"OLY":return"#4584C4";case"NAC":return"#F0EE86";case"TSY":return"#A1C6CA";case"SUN":return"#808080";case"TUC":return"#6A5ACD";case"DIS":return"#005533";case"AIR":return"#808080";case"AWE":return"#FFFFFF";case"EXC":return"#94A8B0";case"HUH":return"#F08080";case"MKK":return"#006400";case"TAW":return"#05117E";case"SHT":return"#BB7796";case"FOT":return"#FFA500";case"RAC":return"#15AE69";case"UNI":return"#A2D7DD";case"TAP":return"#976E9A";case"TWO":return"#C89F05";case"FAN":return"#9ACD32";case"SHS":return"#F6A600";case"LOW":return"#8DC476";case"LMC":return"#009E9B";case"WKS":return"#954535";case"MOS":return"#E0B0FF";case"HEO":return"#87CEFA";case"TSH":return"#48D1CC";case"SHM":return"#FBEC5D";case"CIO":return"#FFBF00";case"STW":return"#FFC0CB";case"CKT":return"#FFD280";case"HIK":return"#8FBE6C";case"KAT":return"#FF8C00";case"SUW":return"#D08A00";case"TKW":return"#A9E2F3";case"ETS":return"#FFFF00";case"AUS":return"#B45529";case"TWW":return"#A81C07";case"KSR":return"#CC5500";case"YUL":return"#40F5F5";case"LOP":return"#FFB3BF";case"TIS":return"#FC8A17";case"SIH":return"#7FFFD4";case"TUM":return"#035F94";case"OCP":return"#00BFFF";case"WCH":return"#FFFF00";case"LET":return"#FF7F00";case"SOH":return"#74B11B";case"TCT":return"#274060";case"NPT":return"#274060";case"WEK":return"#808080"}else{if(t==="lr")return"#d3a809";if(t==="route-lr")switch(e){case"505":return"#b53533";case"506P":return"#000";case"507":case"507P":return"#009651";case"610":return"#3d1f1b";case"610P":return"#4dc6f4";case"614":return"#51b5dc";case"614P":return"#d98386";case"615":return"#f9db4f";case"615P":return"#235970";case"705":return"#7eb554";case"706":return"#9f73a0";case"751":return"#d87f3f";case"751P":return"#000";case"761P":return"#592d76"}}return"#000"}function hn(t,e){if(t==="station-hr"){if(["TST","YMT","CSW","KWH","WHA","HOM","LOF","WTS","KWT","LAT","YAT","TIK","KET","HKU","SYP","WAC","CAB","TIH","NOP","SWH","HAH","POA","HOK","KOW","OLY","NAC","TSY","TUC","DIS","AIR","AWE","HUH","MOS","HEO","TSH","SHM","CIO","STW","CKT","KAT","SUW","TKW","ETS","YUL","LOP","TIS","SIH","WCH","WEK"].includes(e))return"#000";if(e==="SHW")return"#6B4513";if(e==="SUN")return"#C0C0C0";if(e==="DIS")return"#D4AF37";if(e==="HIK")return"#182F4F"}return"#FFF"}function so(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)}const qn=document.getElementById("searchAlert"),Pe=document.getElementById("searchResult"),lo=new ee("#searchDrawer"),co="https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/basemap/wgs84/{z}/{x}/{y}.png",uo="https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/imagery/wgs84/{z}/{x}/{y}.png",fo="https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/label/hk/tc/wgs84/{z}/{x}/{y}.png",Wt='<a target="_blank" href="https://portal.csdi.gov.hk/">&copy; Âú∞ÂúñÁâàÊ¨äÂ±¨È¶ôÊ∏ØÁâπÂçÄÊîøÂ∫ú</a><img style="width:16px;height:16px;" src="https://api.hkmapservice.gov.hk/mapapi/landsdlogo.jpg" />',mn={delay:400,dashArray:[20,40],weight:5,paused:!1,reverse:!1,hardwareAccelerated:!0},ho='<span class="loader m-3"></span>',mo={className:"etaPopup",maxWidth:so()};let zn;const Xn=(t,e)=>{let n=`<div class="alert alert-${e}" role="alert"><div>${t}</div></div>`;qn.innerHTML+=n},po=()=>{qn.innerHTML=""},go=t=>{Array.from(document.querySelectorAll(".list-group-item, .dropdown-item")).forEach(function(e){e.classList.remove("active")}),t&&document.getElementById(t).classList.add("active")},bo=()=>{po(),Pe.innerHTML='<ul class="list-group placeholder-glow"><li class="list-group-item"><span class="placeholder col-12"></span></li><li class="list-group-item"><span class="placeholder col-12"></span></li></ul>';let t=document.getElementById("routeInput").value.toUpperCase();fetch(ROUTE_API.replace("{route}",t)).then(e=>e.json()).then(e=>{Pe.innerHTML=e.map((n,r)=>z("searchResultRow",{"{{id}}":`route-${r}`,"{{href}}":getRouteUrl(n),"{{companyLogo}}":rt(n.company),"{{companyName}}":n.company,"{{text}}":`${n.orig}‚û°Ô∏è${n.dest}`,"{{description}}":n.description}).outerHTML).join(""),reloadRouter()}).catch(function(e){console.log(e),Xn(`Cannot find route ${t} !`,"danger"),Pe.innerHTML=""})},Eo=t=>{pe.clearLayers(),t.stopList.forEach(i=>{const a={company:t.company,route:t.route,routeId:t.routeId,routeType:t.routeType,routeDesc:`${t.orig}‚û°Ô∏è${t.dest}`,dir:t.dir,stop:i.id,name:i.name,address:`${i.lat},${i.long}`,street:i.street,fare:i.fare,fareHoliday:i.fareHoliday,railwayFilterDir:i.railwayFilterDir};var s=L.marker([i.lat,i.long],a).addTo(Ae);s.bindPopup(ho,mo),s.on("click",()=>routeNavigate(getRouteUrl(a,!0))),pe.addLayer(s)});let e=!0,n,r=Nt(t.company,!1),o=Nt(t.company,!0);switch(t.company){case"kmb":n=`kmb/${t.route}/${t.dir}_${t.routeType}`;break;case"ctb":n=`ctb/${t.route}/${t.dir}`;break;case"nwfb":n=`nwfb/${t.route}/${t.dir}`;break;case"nlb":n=`nlb/${t.route}/${t.routeId}`;break;case"mtr":n=`mtr/${t.route}/${t.dir}`;break;case"mtr_hr":n=`mtr_hr/${t.routeId}`,e=!1,r=x("route-hr",t.routeId);break;case"mtr_lr":n=`mtr_lr/${t.route}/${t.dir}`,r=x("route-lr",t.routeId),o=x("route-lr",t.routeId);break}fetch(SPATIAL_API.replace("{path}",`${n}`)).then(i=>i.json()).then(i=>{let a=e?L.polyline.antPath(i,{color:r,pluseColor:o,...mn}):L.polyline(i,{color:r});pe.addLayer(a)}).catch(function(i){let a=t.stopList.map(l=>[l.lat,l.long]);a=[a];let s=e?L.polyline.antPath(a,{color:r,pluseColor:o,...mn}):L.polyline(a,{color:r});pe.addLayer(s)}),pe.addTo(Ae),Ae.fitBounds(pe.getBounds()),window.innerWidth<768&&lo.hide(),Jn("route",t)},pt=async t=>fetch(ETA_API,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify([t])}).then(e=>e.json()).then(e=>e[0]).catch(e=>console.error(e)),vo=async t=>{var e=t.popup._source;let n=z("bookmarkBtn").outerHTML;const r={company:e.options.company,route:e.options.route,routeId:e.options.routeId,routeType:e.options.routeType,routeDesc:e.options.routeDesc,dir:e.options.dir,stop:e.options.stop,name:e.options.name,address:e.options.address,street:e.options.street,fare:e.options.fare,fareHoliday:e.options.fareHoliday,railwayFilterDir:e.options.railwayFilterDir};if(e.options.company==="mtr_hr"){let o={...r,dir:"UT"},i={...r,dir:"DT"},a=[];if(e.options.railwayFilterDir===void 0||e.options.railwayFilterDir&&e.options.railwayFilterDir==="UT"){const f=await pt({...e.options,dir:"UT"}).then(h=>h.map(m=>{let b="",v="";return m.eta!=null&&(b+=`ÂæÄ${m.dest}`,v=`${Math.max(m.eta,0)}ÂàÜÈêò`),m.remark&&(line+=` (${m.remark})`),z("railwayEtaRow",{"{{css}}":`background-color: ${x("route-hr",e.options.routeId)}`,"{{platform}}":m.platform,"{{text}}":b,"{{eta}}":v}).outerHTML}).join("")).catch(()=>"<div>Êú™ÊúâË≥áÊñô</div>");a.push(`<div class="row">
            <div class="col">${f}</div>
            <div class="col-auto">${isBoomarked(o)?n:gt(o)}</div>
            </div>`)}if(e.options.railwayFilterDir===void 0||e.options.railwayFilterDir&&e.options.railwayFilterDir==="DT"){const f=await pt({...e.options,dir:"DT"}).then(h=>h.map(m=>{let b="",v="";return m.eta!=null&&(b+=`ÂæÄ${m.dest}`,v=`${Math.max(m.eta,0)}ÂàÜÈêò`),m.remark&&(line+=` (${m.remark})`),z("railwayEtaRow",{"{{css}}":`background-color: ${x("route-hr",e.options.routeId)}`,"{{platform}}":m.platform,"{{text}}":b,"{{eta}}":v}).outerHTML}).join("")).catch(()=>"<div>Êú™ÊúâË≥áÊñô</div>");a.push(`<div class="row">
            <div class="col">${f}</div>
            <div class="col-auto">${isBoomarked(i)?n:gt(i)}</div>
            </div>`)}const s=a.join('<hr class="my-2">'),l=`background-color: ${x("route-hr",e.options.routeId)}; min-width: 250px;`,c=`background-color: ${x("station-hr",e.options.stop)}; color: ${hn("station-hr",e.options.stop)};`,d=z("etaPopupRailway",{"{{companyLogo}}":rt(e.options.company),"{{route}}":e.options.route,"{{station}}":e.options.name,"{{titleCss}}":l,"{{stationCss}}":c,"{{body}}":s});e._popup.setContent(d)}else{isBoomarked(e.options)||(n=gt(r));const i=`${await pt(e.options).then(f=>f.map(h=>{let m="<div>";if(e.options.company==="mtr_lr"&&(m+=`<span class="badge rounded-pill text-white me-1" style="background-color: ${x("lr")};">${h.platform?h.platform:""}</span>`),h.eta!=null&&(m+=`${Math.max(h.eta,0)}ÂàÜÈêò`),h.remark&&(m+=` (${h.remark})`),e.options.company==="mtr_lr"){m+='<div class="float-end">';for(let b=0;b<h.trainLength;b++)m+="üöÉ";m+="</div>"}return m+="</div>",m}).join("")).catch(()=>"<div>Êú™ÊúâË≥áÊñô</div>")}`;let a=`background-color: ${Nt(e.options.company)}`,s="",l="";const c=e.options.routeDesc;e.options.company==="mtr_lr"&&(a=`background-color: ${x("lr")}; color: ${hn("lr")};`,s=`--border-color: ${x("route-lr",e.options.routeId)};`,l="mtrLrRoute");const d=z("etaPopup",{"{{companyLogo}}":rt(e.options.company),"{{routeNo}}":e.options.route,"{{routeNoClass}}":l,"{{routeNoCss}}":s,"{{title}}":e.options.name,"{{subtitle}}":c,"{{titleCss}}":a,"{{bookmarkBtn}}":n,"{{body}}":i});e._popup.setContent(d)}Jn("stop",e.options)},gt=(t,e=null)=>{if(e===null){let n=document.querySelectorAll("div.list-group-item.group");n.length==0?(e="È†êË®≠Áæ§ÁµÑ",addGroup(e)):e=n[0].dataset.groupName}return`<button class="btn btn-sm btn-outline-warning" onclick="addBookmark('${e}', '${Vn(JSON.stringify(t))}', true)"><i id="bookmarkPopupIcon" class="bi bi-bookmark-plus" aria-label="Êî∂ËóèË∑ØÁ∑ö"></i></button>`},yo=t=>{Pe.innerHTML="",Array.from(document.querySelectorAll("[data-route-type]")).forEach(function(e){e.dataset.routeType===t?e.classList.remove("d-none"):e.classList.add("d-none")}),t==="mtr"&&(Pe.innerHTML=zn.map((e,n)=>z("searchResultRailwayRow",{"{{id}}":`route-${n}`,"{{href}}":getRouteUrl(e),"{{backgroundColor}}":x("route-hr",e.routeId),"{{text}}":`${e.route} (${e.orig}‚ÜîÔ∏è${e.dest})`}).outerHTML).join(""),reloadRouter())},_o=t=>{pe.eachLayer(function(e){e.options.stop===t&&(Ae.setView(e.getLatLng(),16),e.openPopup())})},Jn=(t,e)=>{const n="https://siri-shortcut-hk-bus-eta.pages.dev",r="È¶ôÊ∏Ø‰∫§ÈÄöÂà∞Á´ôÊôÇÈñì",o=e.orig?e.orig:e.routeDesc.split("‚û°Ô∏è")[0],i=e.dest?e.dest:e.routeDesc.split("‚û°Ô∏è")[1];let a=r,s=`${fn(e.company)} ${e.route}Ôºå${e.company==="mtr_hr"?"‰æÜÂæÄ":"Áî±"}${o}Ëá≥${i}`;e.stopList&&(s+="ÔºåÈÄîÁ∂ì",e.stopList.forEach(d=>{s+=`${d.name}„ÄÅ`}));const l=n+window.location.pathname;let c={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:fn(e.company),item:n+"/"+e.company},{"@type":"ListItem",position:2,name:e.route,item:n+getRouteUrl(e)}]};e.company==="mtr_hr"?a=e.route+" - "+r:a=e.route+" ÂæÄ"+i+" - "+r,t==="stop"&&(a=e.name+" - "+a,c.itemListElement.push({"@type":"ListItem",position:3,name:e.name,item:n+getRouteUrl(e,!0)})),document.title=a,document.querySelector('meta[property="og:title"]').content=a,document.querySelector('meta[name="twitter:title"]').content=a,document.querySelector('meta[name="description"]').content=s,document.querySelector('meta[property="og:description"]').content=s,document.querySelector('meta[name="twitter:description"]').content=s,document.querySelector('meta[property="og:url"]').content=l,document.querySelector('meta[name="twitter:url"]').content=l,document.querySelector('link[rel="canonical"]').content=l,document.querySelector('script[type="application/ld+json"]').innerHTML=JSON.stringify(c)};document.getElementById("btnSearch").onclick=bo;document.getElementById("routeInput").addEventListener("keypress",function(t){t.key==="Enter"&&(t.preventDefault(),document.getElementById("btnSearch").click())});var pe=new L.FeatureGroup;const Qn=L.tileLayer(co,{maxZoom:20,attribution:Wt}),wo=L.tileLayer(uo,{maxZoom:20,attribution:Wt}),Zn=L.tileLayer(fo,{maxZoom:20,attribution:Wt}),So={Âú∞ÂΩ¢Âúñ:Qn,ÂΩ±ÂÉèÂú∞Âúñ:wo},Ao={Âú∞ÂêçÊ®ôÁ±§:Zn},Ae=L.map("map",{center:[22.322005998683245,114.17846497109828],zoom:13,layers:[Qn,Zn]});L.control.layers(So,Ao,{hideSingleBase:!0}).addTo(Ae);Ae.on("popupopen",vo);fetch(SIRI_SHORTCUT_UPDATE_API).then(t=>t.json()).then(t=>{document.getElementById("getSiriShortcut").setAttribute("href",t.url),document.getElementById("siriShortcutVersion").innerHTML=`(v${t.version})`});zn=await fetch(ROUTE_API.replace("{route}","mtr_hr")).then(t=>t.json());window.renderRoute=Eo;window.routeTypeClick=yo;window.triggerStopClick=_o;window.alert=Xn;window.setActive=go;const To="modal",Co="bs.modal",K=`.${Co}`,Do=".data-api",ko="Escape",Io=`hide${K}`,Oo=`hidePrevented${K}`,jn=`hidden${K}`,er=`show${K}`,No=`shown${K}`,Lo=`resize${K}`,Fo=`click.dismiss${K}`,Bo=`mousedown.dismiss${K}`,$o=`keydown.dismiss${K}`,Po=`click${K}${Do}`,pn="modal-open",Mo="fade",gn="show",bt="modal-static",Ro=".modal.show",xo=".modal-dialog",Ho=".modal-body",Wo='[data-bs-toggle="modal"]',Ko={backdrop:!0,focus:!0,keyboard:!0},Yo={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ee extends Mn{constructor(e,n){super(e,n),this._dialog=B.findOne(xo,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ot,this._addEventListeners()}static get Default(){return Ko}static get DefaultType(){return Yo}static get NAME(){return To}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||y.trigger(this._element,er,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(pn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||y.trigger(this._element,Io).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(gn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){y.off(window,K),y.off(this._dialog,K),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new xn({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Wn({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const n=B.findOne(Ho,this._dialog);n&&(n.scrollTop=0),Dn(this._element),this._element.classList.add(gn);const r=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,y.trigger(this._element,No,{relatedTarget:e})};this._queueCallback(r,this._dialog,this._isAnimated())}_addEventListeners(){y.on(this._element,$o,e=>{if(e.key===ko){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),y.on(window,Lo,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),y.on(this._element,Bo,e=>{y.one(this._element,Fo,n=>{if(!(this._element!==e.target||this._element!==n.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(pn),this._resetAdjustments(),this._scrollBar.reset(),y.trigger(this._element,jn)})}_isAnimated(){return this._element.classList.contains(Mo)}_triggerBackdropTransition(){if(y.trigger(this._element,Oo).defaultPrevented)return;const n=this._element.scrollHeight>document.documentElement.clientHeight,r=this._element.style.overflowY;r==="hidden"||this._element.classList.contains(bt)||(n||(this._element.style.overflowY="hidden"),this._element.classList.add(bt),this._queueCallback(()=>{this._element.classList.remove(bt),this._queueCallback(()=>{this._element.style.overflowY=r},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,n=this._scrollBar.getWidth(),r=n>0;if(r&&!e){const o=Qt()?"paddingLeft":"paddingRight";this._element.style[o]=`${n}px`}if(!r&&e){const o=Qt()?"paddingRight":"paddingLeft";this._element.style[o]=`${n}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,n){return this.each(function(){const r=Ee.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e](n)}})}}y.on(document,Po,Wo,function(t){const e=B.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),y.one(e,er,o=>{o.defaultPrevented||y.one(e,jn,()=>{Mt(this)&&this.focus()})});const n=B.findOne(Ro);n&&Ee.getInstance(n).hide(),Ee.getOrCreateInstance(e).toggle(this)});Hn(Ee);In(Ee);/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bn(Object(n),!0).forEach(function(r){Uo(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Qe(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qe=function(e){return typeof e}:Qe=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(t)}function Uo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function te(){return te=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},te.apply(this,arguments)}function Vo(t,e){if(t==null)return{};var n={},r=Object.keys(t),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function Go(t,e){if(t==null)return{};var n=Vo(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}var qo="1.15.2";function j(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var re=j(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ke=j(/Edge/i),En=j(/firefox/i),Me=j(/safari/i)&&!j(/chrome/i)&&!j(/android/i),tr=j(/iP(ad|od|hone)/i),nr=j(/chrome/i)&&j(/android/i),rr={capture:!1,passive:!1};function w(t,e,n){t.addEventListener(e,n,!re&&rr)}function _(t,e,n){t.removeEventListener(e,n,!re&&rr)}function ot(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function zo(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function G(t,e,n,r){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&ot(t,e):ot(t,e))||r&&t===n)return t;if(t===n)break}while(t=zo(t))}return null}var vn=/\s+/g;function M(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(vn," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(vn," ")}}function g(t,e,n){var r=t&&t.style;if(r){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=n+(typeof n=="string"?"":"px")}}function Te(t,e){var n="";if(typeof t=="string")n=t;else do{var r=g(t,"transform");r&&r!=="none"&&(n=r+" "+n)}while(!e&&(t=t.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function or(t,e,n){if(t){var r=t.getElementsByTagName(e),o=0,i=r.length;if(n)for(;o<i;o++)n(r[o],o);return r}return[]}function X(){var t=document.scrollingElement;return t||document.documentElement}function D(t,e,n,r,o){if(!(!t.getBoundingClientRect&&t!==window)){var i,a,s,l,c,d,f;if(t!==window&&t.parentNode&&t!==X()?(i=t.getBoundingClientRect(),a=i.top,s=i.left,l=i.bottom,c=i.right,d=i.height,f=i.width):(a=0,s=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,f=window.innerWidth),(e||n)&&t!==window&&(o=o||t.parentNode,!re))do if(o&&o.getBoundingClientRect&&(g(o,"transform")!=="none"||n&&g(o,"position")!=="static")){var h=o.getBoundingClientRect();a-=h.top+parseInt(g(o,"border-top-width")),s-=h.left+parseInt(g(o,"border-left-width")),l=a+i.height,c=s+i.width;break}while(o=o.parentNode);if(r&&t!==window){var m=Te(o||t),b=m&&m.a,v=m&&m.d;m&&(a/=v,s/=b,f/=b,d/=v,l=a+d,c=s+f)}return{top:a,left:s,bottom:l,right:c,width:f,height:d}}}function yn(t,e,n){for(var r=ce(t,!0),o=D(t)[e];r;){var i=D(r)[n],a=void 0;if(a=o>=i,!a)return r;if(r===X())break;r=ce(r,!1)}return!1}function Ce(t,e,n,r){for(var o=0,i=0,a=t.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==p.ghost&&(r||a[i]!==p.dragged)&&G(a[i],n.draggable,t,!1)){if(o===e)return a[i];o++}i++}return null}function Kt(t,e){for(var n=t.lastElementChild;n&&(n===p.ghost||g(n,"display")==="none"||e&&!ot(n,e));)n=n.previousElementSibling;return n||null}function W(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==p.clone&&(!e||ot(t,e))&&n++;return n}function _n(t){var e=0,n=0,r=X();if(t)do{var o=Te(t),i=o.a,a=o.d;e+=t.scrollLeft*i,n+=t.scrollTop*a}while(t!==r&&(t=t.parentNode));return[e,n]}function Xo(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[n][r])return Number(n)}return-1}function ce(t,e){if(!t||!t.getBoundingClientRect)return X();var n=t,r=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=g(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return X();if(r||e)return n;r=!0}}while(n=n.parentNode);return X()}function Jo(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Et(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var Re;function ir(t,e){return function(){if(!Re){var n=arguments,r=this;n.length===1?t.call(r,n[0]):t.apply(r,n),Re=setTimeout(function(){Re=void 0},e)}}}function Qo(){clearTimeout(Re),Re=void 0}function ar(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function sr(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function lr(t,e,n){var r={};return Array.from(t.children).forEach(function(o){var i,a,s,l;if(!(!G(o,e.draggable,t,!1)||o.animated||o===n)){var c=D(o);r.left=Math.min((i=r.left)!==null&&i!==void 0?i:1/0,c.left),r.top=Math.min((a=r.top)!==null&&a!==void 0?a:1/0,c.top),r.right=Math.max((s=r.right)!==null&&s!==void 0?s:-1/0,c.right),r.bottom=Math.max((l=r.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var H="Sortable"+new Date().getTime();function Zo(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(o){if(!(g(o,"display")==="none"||o===p.ghost)){t.push({target:o,rect:D(o)});var i=J({},t[t.length-1].rect);if(o.thisAnimationDuration){var a=Te(o,!0);a&&(i.top-=a.f,i.left-=a.e)}o.fromRect=i}})}},addAnimationState:function(r){t.push(r)},removeAnimationState:function(r){t.splice(Xo(t,{target:r}),1)},animateAll:function(r){var o=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var i=!1,a=0;t.forEach(function(s){var l=0,c=s.target,d=c.fromRect,f=D(c),h=c.prevFromRect,m=c.prevToRect,b=s.rect,v=Te(c,!0);v&&(f.top-=v.f,f.left-=v.e),c.toRect=f,c.thisAnimationDuration&&Et(h,f)&&!Et(d,f)&&(b.top-f.top)/(b.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(l=ei(b,h,m,o.options)),Et(f,d)||(c.prevFromRect=d,c.prevToRect=f,l||(l=o.options.animation),o.animate(c,b,f,l)),l&&(i=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),i?e=setTimeout(function(){typeof r=="function"&&r()},a):typeof r=="function"&&r(),t=[]},animate:function(r,o,i,a){if(a){g(r,"transition",""),g(r,"transform","");var s=Te(this.el),l=s&&s.a,c=s&&s.d,d=(o.left-i.left)/(l||1),f=(o.top-i.top)/(c||1);r.animatingX=!!d,r.animatingY=!!f,g(r,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=jo(r),g(r,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),g(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){g(r,"transition",""),g(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},a)}}}}function jo(t){return t.offsetWidth}function ei(t,e,n,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*r.animation}var ve=[],vt={initializeByDefault:!0},Ye={mount:function(e){for(var n in vt)vt.hasOwnProperty(n)&&!(n in e)&&(e[n]=vt[n]);ve.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),ve.push(e)},pluginEvent:function(e,n,r){var o=this;this.eventCanceled=!1,r.cancel=function(){o.eventCanceled=!0};var i=e+"Global";ve.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][i]&&n[a.pluginName][i](J({sortable:n},r)),n.options[a.pluginName]&&n[a.pluginName][e]&&n[a.pluginName][e](J({sortable:n},r)))})},initializePlugins:function(e,n,r,o){ve.forEach(function(s){var l=s.pluginName;if(!(!e.options[l]&&!s.initializeByDefault)){var c=new s(e,n,e.options);c.sortable=e,c.options=e.options,e[l]=c,te(r,c.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);typeof a<"u"&&(e.options[i]=a)}},getEventProperties:function(e,n){var r={};return ve.forEach(function(o){typeof o.eventProperties=="function"&&te(r,o.eventProperties.call(n[o.pluginName],e))}),r},modifyOption:function(e,n,r){var o;return ve.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(o=i.optionListeners[n].call(e[i.pluginName],r))}),o}};function ti(t){var e=t.sortable,n=t.rootEl,r=t.name,o=t.targetEl,i=t.cloneEl,a=t.toEl,s=t.fromEl,l=t.oldIndex,c=t.newIndex,d=t.oldDraggableIndex,f=t.newDraggableIndex,h=t.originalEvent,m=t.putSortable,b=t.extraEventProperties;if(e=e||n&&n[H],!!e){var v,Y=e.options,Q="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!re&&!Ke?v=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent(r,!0,!0)),v.to=a||n,v.from=s||n,v.item=o||n,v.clone=i,v.oldIndex=l,v.newIndex=c,v.oldDraggableIndex=d,v.newDraggableIndex=f,v.originalEvent=h,v.pullMode=m?m.lastPutMode:void 0;var O=J(J({},b),Ye.getEventProperties(r,e));for(var U in O)v[U]=O[U];n&&n.dispatchEvent(v),Y[Q]&&Y[Q].call(e,v)}}var ni=["evt"],F=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=r.evt,i=Go(r,ni);Ye.pluginEvent.bind(p)(e,n,J({dragEl:u,parentEl:T,ghostEl:E,rootEl:S,nextEl:ge,lastDownEl:Ze,cloneEl:A,cloneHidden:le,dragStarted:Le,putSortable:k,activeSortable:p.active,originalEvent:o,oldIndex:we,oldDraggableIndex:xe,newIndex:R,newDraggableIndex:se,hideGhostForTarget:fr,unhideGhostForTarget:hr,cloneNowHidden:function(){le=!0},cloneNowShown:function(){le=!1},dispatchSortableEvent:function(s){N({sortable:n,name:s,originalEvent:o})}},i))};function N(t){ti(J({putSortable:k,cloneEl:A,targetEl:u,rootEl:S,oldIndex:we,oldDraggableIndex:xe,newIndex:R,newDraggableIndex:se},t))}var u,T,E,S,ge,Ze,A,le,we,R,xe,se,qe,k,_e=!1,it=!1,at=[],he,V,yt,_t,wn,Sn,Le,ye,He,We=!1,ze=!1,je,I,wt=[],Lt=!1,st=[],ct=typeof document<"u",Xe=tr,An=Ke||re?"cssFloat":"float",ri=ct&&!nr&&!tr&&"draggable"in document.createElement("div"),cr=function(){if(ct){if(re)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),ur=function(e,n){var r=g(e),o=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),i=Ce(e,0,n),a=Ce(e,1,n),s=i&&g(i),l=a&&g(a),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+D(i).width,d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+D(a).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return i&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=o&&r[An]==="none"||a&&r[An]==="none"&&c+d>o)?"vertical":"horizontal"},oi=function(e,n,r){var o=r?e.left:e.top,i=r?e.right:e.bottom,a=r?e.width:e.height,s=r?n.left:n.top,l=r?n.right:n.bottom,c=r?n.width:n.height;return o===s||i===l||o+a/2===s+c/2},ii=function(e,n){var r;return at.some(function(o){var i=o[H].options.emptyInsertThreshold;if(!(!i||Kt(o))){var a=D(o),s=e>=a.left-i&&e<=a.right+i,l=n>=a.top-i&&n<=a.bottom+i;if(s&&l)return r=o}}),r},dr=function(e){function n(i,a){return function(s,l,c,d){var f=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return n(i(s,l,c,d),a)(s,l,c,d);var h=(a?s:l).options.group.name;return i===!0||typeof i=="string"&&i===h||i.join&&i.indexOf(h)>-1}}var r={},o=e.group;(!o||Qe(o)!="object")&&(o={name:o}),r.name=o.name,r.checkPull=n(o.pull,!0),r.checkPut=n(o.put),r.revertClone=o.revertClone,e.group=r},fr=function(){!cr&&E&&g(E,"display","none")},hr=function(){!cr&&E&&g(E,"display","")};ct&&!nr&&document.addEventListener("click",function(t){if(it)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),it=!1,!1},!0);var me=function(e){if(u){e=e.touches?e.touches[0]:e;var n=ii(e.clientX,e.clientY);if(n){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);r.target=r.rootEl=n,r.preventDefault=void 0,r.stopPropagation=void 0,n[H]._onDragOver(r)}}},ai=function(e){u&&u.parentNode[H]._isOutsideThisEl(e.target)};function p(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=te({},e),t[H]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ur(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:p.supportPointer!==!1&&"PointerEvent"in window&&!Me,emptyInsertThreshold:5};Ye.initializePlugins(this,t,n);for(var r in n)!(r in e)&&(e[r]=n[r]);dr(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:ri,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?w(t,"pointerdown",this._onTapStart):(w(t,"mousedown",this._onTapStart),w(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(w(t,"dragover",this),w(t,"dragenter",this)),at.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),te(this,Zo())}p.prototype={constructor:p,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(ye=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,u):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,r=this.el,o=this.options,i=o.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(s||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,d=o.filter;if(mi(r),!u&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||o.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Me&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=G(l,o.draggable,r,!1),!(l&&l.animated)&&Ze!==l)){if(we=W(l),xe=W(l,o.draggable),typeof d=="function"){if(d.call(this,e,l,this)){N({sortable:n,rootEl:c,name:"filter",targetEl:l,toEl:r,fromEl:r}),F("filter",n,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=G(c,f.trim(),r,!1),f)return N({sortable:n,rootEl:f,name:"filter",targetEl:l,fromEl:r,toEl:r}),F("filter",n,{evt:e}),!0}),d)){i&&e.cancelable&&e.preventDefault();return}o.handle&&!G(c,o.handle,r,!1)||this._prepareDragStart(e,s,l)}}},_prepareDragStart:function(e,n,r){var o=this,i=o.el,a=o.options,s=i.ownerDocument,l;if(r&&!u&&r.parentNode===i){var c=D(r);if(S=i,u=r,T=u.parentNode,ge=u.nextSibling,Ze=r,qe=a.group,p.dragged=u,he={target:u,clientX:(n||e).clientX,clientY:(n||e).clientY},wn=he.clientX-c.left,Sn=he.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,u.style["will-change"]="all",l=function(){if(F("delayEnded",o,{evt:e}),p.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!En&&o.nativeDraggable&&(u.draggable=!0),o._triggerDragStart(e,n),N({sortable:o,name:"choose",originalEvent:e}),M(u,a.chosenClass,!0)},a.ignore.split(",").forEach(function(d){or(u,d.trim(),St)}),w(s,"dragover",me),w(s,"mousemove",me),w(s,"touchmove",me),w(s,"mouseup",o._onDrop),w(s,"touchend",o._onDrop),w(s,"touchcancel",o._onDrop),En&&this.nativeDraggable&&(this.options.touchStartThreshold=4,u.draggable=!0),F("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Ke||re))){if(p.eventCanceled){this._onDrop();return}w(s,"mouseup",o._disableDelayedDrag),w(s,"touchend",o._disableDelayedDrag),w(s,"touchcancel",o._disableDelayedDrag),w(s,"mousemove",o._delayedDragTouchMoveHandler),w(s,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&w(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){u&&St(u),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?w(document,"pointermove",this._onTouchMove):n?w(document,"touchmove",this._onTouchMove):w(document,"mousemove",this._onTouchMove):(w(u,"dragend",this),w(S,"dragstart",this._onDragStart));try{document.selection?et(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(_e=!1,S&&u){F("dragStarted",this,{evt:n}),this.nativeDraggable&&w(document,"dragover",ai);var r=this.options;!e&&M(u,r.dragClass,!1),M(u,r.ghostClass,!0),p.active=this,e&&this._appendGhost(),N({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(V){this._lastX=V.clientX,this._lastY=V.clientY,fr();for(var e=document.elementFromPoint(V.clientX,V.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(V.clientX,V.clientY),e!==n);)n=e;if(u.parentNode[H]._isOutsideThisEl(e),n)do{if(n[H]){var r=void 0;if(r=n[H]._onDragOver({clientX:V.clientX,clientY:V.clientY,target:e,rootEl:n}),r&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);hr()}},_onTouchMove:function(e){if(he){var n=this.options,r=n.fallbackTolerance,o=n.fallbackOffset,i=e.touches?e.touches[0]:e,a=E&&Te(E,!0),s=E&&a&&a.a,l=E&&a&&a.d,c=Xe&&I&&_n(I),d=(i.clientX-he.clientX+o.x)/(s||1)+(c?c[0]-wt[0]:0)/(s||1),f=(i.clientY-he.clientY+o.y)/(l||1)+(c?c[1]-wt[1]:0)/(l||1);if(!p.active&&!_e){if(r&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(E){a?(a.e+=d-(yt||0),a.f+=f-(_t||0)):a={a:1,b:0,c:0,d:1,e:d,f};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");g(E,"webkitTransform",h),g(E,"mozTransform",h),g(E,"msTransform",h),g(E,"transform",h),yt=d,_t=f,V=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!E){var e=this.options.fallbackOnBody?document.body:S,n=D(u,!0,Xe,!0,e),r=this.options;if(Xe){for(I=e;g(I,"position")==="static"&&g(I,"transform")==="none"&&I!==document;)I=I.parentNode;I!==document.body&&I!==document.documentElement?(I===document&&(I=X()),n.top+=I.scrollTop,n.left+=I.scrollLeft):I=X(),wt=_n(I)}E=u.cloneNode(!0),M(E,r.ghostClass,!1),M(E,r.fallbackClass,!0),M(E,r.dragClass,!0),g(E,"transition",""),g(E,"transform",""),g(E,"box-sizing","border-box"),g(E,"margin",0),g(E,"top",n.top),g(E,"left",n.left),g(E,"width",n.width),g(E,"height",n.height),g(E,"opacity","0.8"),g(E,"position",Xe?"absolute":"fixed"),g(E,"zIndex","100000"),g(E,"pointerEvents","none"),p.ghost=E,e.appendChild(E),g(E,"transform-origin",wn/parseInt(E.style.width)*100+"% "+Sn/parseInt(E.style.height)*100+"%")}},_onDragStart:function(e,n){var r=this,o=e.dataTransfer,i=r.options;if(F("dragStart",this,{evt:e}),p.eventCanceled){this._onDrop();return}F("setupClone",this),p.eventCanceled||(A=sr(u),A.removeAttribute("id"),A.draggable=!1,A.style["will-change"]="",this._hideClone(),M(A,this.options.chosenClass,!1),p.clone=A),r.cloneId=et(function(){F("clone",r),!p.eventCanceled&&(r.options.removeCloneOnHide||S.insertBefore(A,u),r._hideClone(),N({sortable:r,name:"clone"}))}),!n&&M(u,i.dragClass,!0),n?(it=!0,r._loopId=setInterval(r._emulateDragOver,50)):(_(document,"mouseup",r._onDrop),_(document,"touchend",r._onDrop),_(document,"touchcancel",r._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(r,o,u)),w(document,"drop",r),g(u,"transform","translateZ(0)")),_e=!0,r._dragStartId=et(r._dragStarted.bind(r,n,e)),w(document,"selectstart",r),Le=!0,Me&&g(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,r=e.target,o,i,a,s=this.options,l=s.group,c=p.active,d=qe===l,f=s.sort,h=k||c,m,b=this,v=!1;if(Lt)return;function Y(Ne,Er){F(Ne,b,J({evt:e,isOwner:d,axis:m?"vertical":"horizontal",revert:a,dragRect:o,targetRect:i,canSort:f,fromSortable:h,target:r,completed:O,onMove:function(Jt,vr){return Je(S,n,u,o,Jt,D(Jt),e,vr)},changed:U},Er))}function Q(){Y("dragOverAnimationCapture"),b.captureAnimationState(),b!==h&&h.captureAnimationState()}function O(Ne){return Y("dragOverCompleted",{insertion:Ne}),Ne&&(d?c._hideClone():c._showClone(b),b!==h&&(M(u,k?k.options.ghostClass:c.options.ghostClass,!1),M(u,s.ghostClass,!0)),k!==b&&b!==p.active?k=b:b===p.active&&k&&(k=null),h===b&&(b._ignoreWhileAnimating=r),b.animateAll(function(){Y("dragOverAnimationComplete"),b._ignoreWhileAnimating=null}),b!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(r===u&&!u.animated||r===n&&!r.animated)&&(ye=null),!s.dragoverBubble&&!e.rootEl&&r!==document&&(u.parentNode[H]._isOutsideThisEl(e.target),!Ne&&me(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function U(){R=W(u),se=W(u,s.draggable),N({sortable:b,name:"change",toEl:n,newIndex:R,newDraggableIndex:se,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=G(r,s.draggable,n,!0),Y("dragOver"),p.eventCanceled)return v;if(u.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||b._ignoreWhileAnimating===r)return O(!1);if(it=!1,c&&!s.disabled&&(d?f||(a=T!==S):k===this||(this.lastPutMode=qe.checkPull(this,c,u,e))&&l.checkPut(this,c,u,e))){if(m=this._getDirection(e,r)==="vertical",o=D(u),Y("dragOverValid"),p.eventCanceled)return v;if(a)return T=S,Q(),this._hideClone(),Y("revert"),p.eventCanceled||(ge?S.insertBefore(u,ge):S.appendChild(u)),O(!0);var $=Kt(n,s.draggable);if(!$||ui(e,m,this)&&!$.animated){if($===u)return O(!1);if($&&n===e.target&&(r=$),r&&(i=D(r)),Je(S,n,u,o,r,i,e,!!r)!==!1)return Q(),$&&$.nextSibling?n.insertBefore(u,$.nextSibling):n.appendChild(u),T=n,U(),O(!0)}else if($&&ci(e,m,this)){var ue=Ce(n,0,s,!0);if(ue===u)return O(!1);if(r=ue,i=D(r),Je(S,n,u,o,r,i,e,!1)!==!1)return Q(),n.insertBefore(u,ue),T=n,U(),O(!0)}else if(r.parentNode===n){i=D(r);var q=0,de,De=u.parentNode!==n,P=!oi(u.animated&&u.toRect||o,r.animated&&r.toRect||i,m),ke=m?"top":"left",oe=yn(r,"top","top")||yn(u,"top","top"),Ie=oe?oe.scrollTop:void 0;ye!==r&&(de=i[ke],We=!1,ze=!P&&s.invertSwap||De),q=di(e,r,i,m,P?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,ze,ye===r);var Z;if(q!==0){var fe=W(u);do fe-=q,Z=T.children[fe];while(Z&&(g(Z,"display")==="none"||Z===E))}if(q===0||Z===r)return O(!1);ye=r,He=q;var Oe=r.nextElementSibling,ie=!1;ie=q===1;var Ue=Je(S,n,u,o,r,i,e,ie);if(Ue!==!1)return(Ue===1||Ue===-1)&&(ie=Ue===1),Lt=!0,setTimeout(li,30),Q(),ie&&!Oe?n.appendChild(u):r.parentNode.insertBefore(u,ie?Oe:r),oe&&ar(oe,0,Ie-oe.scrollTop),T=u.parentNode,de!==void 0&&!ze&&(je=Math.abs(de-D(r)[ke])),U(),O(!0)}if(n.contains(u))return O(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",me),_(document,"mousemove",me),_(document,"touchmove",me)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var n=this.el,r=this.options;if(R=W(u),se=W(u,r.draggable),F("drop",this,{evt:e}),T=u&&u.parentNode,R=W(u),se=W(u,r.draggable),p.eventCanceled){this._nulling();return}_e=!1,ze=!1,We=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ft(this.cloneId),Ft(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Me&&g(document.body,"user-select",""),g(u,"transform",""),e&&(Le&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),E&&E.parentNode&&E.parentNode.removeChild(E),(S===T||k&&k.lastPutMode!=="clone")&&A&&A.parentNode&&A.parentNode.removeChild(A),u&&(this.nativeDraggable&&_(u,"dragend",this),St(u),u.style["will-change"]="",Le&&!_e&&M(u,k?k.options.ghostClass:this.options.ghostClass,!1),M(u,this.options.chosenClass,!1),N({sortable:this,name:"unchoose",toEl:T,newIndex:null,newDraggableIndex:null,originalEvent:e}),S!==T?(R>=0&&(N({rootEl:T,name:"add",toEl:T,fromEl:S,originalEvent:e}),N({sortable:this,name:"remove",toEl:T,originalEvent:e}),N({rootEl:T,name:"sort",toEl:T,fromEl:S,originalEvent:e}),N({sortable:this,name:"sort",toEl:T,originalEvent:e})),k&&k.save()):R!==we&&R>=0&&(N({sortable:this,name:"update",toEl:T,originalEvent:e}),N({sortable:this,name:"sort",toEl:T,originalEvent:e})),p.active&&((R==null||R===-1)&&(R=we,se=xe),N({sortable:this,name:"end",toEl:T,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){F("nulling",this),S=u=T=E=ge=A=Ze=le=he=V=Le=R=se=we=xe=ye=He=k=qe=p.dragged=p.ghost=p.clone=p.active=null,st.forEach(function(e){e.checked=!0}),st.length=yt=_t=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":u&&(this._onDragOver(e),si(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,r=this.el.children,o=0,i=r.length,a=this.options;o<i;o++)n=r[o],G(n,a.draggable,this.el,!1)&&e.push(n.getAttribute(a.dataIdAttr)||hi(n));return e},sort:function(e,n){var r={},o=this.el;this.toArray().forEach(function(i,a){var s=o.children[a];G(s,this.options.draggable,o,!1)&&(r[i]=s)},this),n&&this.captureAnimationState(),e.forEach(function(i){r[i]&&(o.removeChild(r[i]),o.appendChild(r[i]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return G(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var r=this.options;if(n===void 0)return r[e];var o=Ye.modifyOption(this,e,n);typeof o<"u"?r[e]=o:r[e]=n,e==="group"&&dr(r)},destroy:function(){F("destroy",this);var e=this.el;e[H]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),at.splice(at.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!le){if(F("hideClone",this),p.eventCanceled)return;g(A,"display","none"),this.options.removeCloneOnHide&&A.parentNode&&A.parentNode.removeChild(A),le=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(le){if(F("showClone",this),p.eventCanceled)return;u.parentNode==S&&!this.options.group.revertClone?S.insertBefore(A,u):ge?S.insertBefore(A,ge):S.appendChild(A),this.options.group.revertClone&&this.animate(u,A),g(A,"display",""),le=!1}}};function si(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Je(t,e,n,r,o,i,a,s){var l,c=t[H],d=c.options.onMove,f;return window.CustomEvent&&!re&&!Ke?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=n,l.draggedRect=r,l.related=o||e,l.relatedRect=i||D(e),l.willInsertAfter=s,l.originalEvent=a,t.dispatchEvent(l),d&&(f=d.call(c,l,a)),f}function St(t){t.draggable=!1}function li(){Lt=!1}function ci(t,e,n){var r=D(Ce(n.el,0,n.options,!0)),o=lr(n.el,n.options,E),i=10;return e?t.clientX<o.left-i||t.clientY<r.top&&t.clientX<r.right:t.clientY<o.top-i||t.clientY<r.bottom&&t.clientX<r.left}function ui(t,e,n){var r=D(Kt(n.el,n.options.draggable)),o=lr(n.el,n.options,E),i=10;return e?t.clientX>o.right+i||t.clientY>r.bottom&&t.clientX>r.left:t.clientY>o.bottom+i||t.clientX>r.right&&t.clientY>r.top}function di(t,e,n,r,o,i,a,s){var l=r?t.clientY:t.clientX,c=r?n.height:n.width,d=r?n.top:n.left,f=r?n.bottom:n.right,h=!1;if(!a){if(s&&je<c*o){if(!We&&(He===1?l>d+c*i/2:l<f-c*i/2)&&(We=!0),We)h=!0;else if(He===1?l<d+je:l>f-je)return-He}else if(l>d+c*(1-o)/2&&l<f-c*(1-o)/2)return fi(e)}return h=h||a,h&&(l<d+c*i/2||l>f-c*i/2)?l>d+c/2?1:-1:0}function fi(t){return W(u)<W(t)?1:-1}function hi(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;n--;)r+=e.charCodeAt(n);return r.toString(36)}function mi(t){st.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var r=e[n];r.checked&&st.push(r)}}function et(t){return setTimeout(t,0)}function Ft(t){return clearTimeout(t)}ct&&w(document,"touchmove",function(t){(p.active||_e)&&t.cancelable&&t.preventDefault()});p.utils={on:w,off:_,css:g,find:or,is:function(e,n){return!!G(e,n,e,!1)},extend:Jo,throttle:ir,closest:G,toggleClass:M,clone:sr,index:W,nextTick:et,cancelNextTick:Ft,detectDirection:ur,getChild:Ce};p.get=function(t){return t[H]};p.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(p.utils=J(J({},p.utils),r.utils)),Ye.mount(r)})};p.create=function(t,e){return new p(t,e)};p.version=qo;var C=[],Fe,Bt,$t=!1,At,Tt,lt,Be;function pi(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var r=n.originalEvent;this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):this.options.supportPointer?w(document,"pointermove",this._handleFallbackAutoScroll):r.touches?w(document,"touchmove",this._handleFallbackAutoScroll):w(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var r=n.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),Tn(),tt(),Qo()},nulling:function(){lt=Bt=Fe=$t=Be=At=Tt=null,C.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,r){var o=this,i=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(i,a);if(lt=n,r||this.options.forceAutoScrollFallback||Ke||re||Me){Ct(n,this.options,s,r);var l=ce(s,!0);$t&&(!Be||i!==At||a!==Tt)&&(Be&&Tn(),Be=setInterval(function(){var c=ce(document.elementFromPoint(i,a),!0);c!==l&&(l=c,tt()),Ct(n,o.options,c,r)},10),At=i,Tt=a)}else{if(!this.options.bubbleScroll||ce(s,!0)===X()){tt();return}Ct(n,this.options,ce(s,!1),!1)}}},te(t,{pluginName:"scroll",initializeByDefault:!0})}function tt(){C.forEach(function(t){clearInterval(t.pid)}),C=[]}function Tn(){clearInterval(Be)}var Ct=ir(function(t,e,n,r){if(e.scroll){var o=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,s=e.scrollSpeed,l=X(),c=!1,d;Bt!==n&&(Bt=n,tt(),Fe=e.scroll,d=e.scrollFn,Fe===!0&&(Fe=ce(n,!0)));var f=0,h=Fe;do{var m=h,b=D(m),v=b.top,Y=b.bottom,Q=b.left,O=b.right,U=b.width,$=b.height,ue=void 0,q=void 0,de=m.scrollWidth,De=m.scrollHeight,P=g(m),ke=m.scrollLeft,oe=m.scrollTop;m===l?(ue=U<de&&(P.overflowX==="auto"||P.overflowX==="scroll"||P.overflowX==="visible"),q=$<De&&(P.overflowY==="auto"||P.overflowY==="scroll"||P.overflowY==="visible")):(ue=U<de&&(P.overflowX==="auto"||P.overflowX==="scroll"),q=$<De&&(P.overflowY==="auto"||P.overflowY==="scroll"));var Ie=ue&&(Math.abs(O-o)<=a&&ke+U<de)-(Math.abs(Q-o)<=a&&!!ke),Z=q&&(Math.abs(Y-i)<=a&&oe+$<De)-(Math.abs(v-i)<=a&&!!oe);if(!C[f])for(var fe=0;fe<=f;fe++)C[fe]||(C[fe]={});(C[f].vx!=Ie||C[f].vy!=Z||C[f].el!==m)&&(C[f].el=m,C[f].vx=Ie,C[f].vy=Z,clearInterval(C[f].pid),(Ie!=0||Z!=0)&&(c=!0,C[f].pid=setInterval(function(){r&&this.layer===0&&p.active._onTouchMove(lt);var Oe=C[this.layer].vy?C[this.layer].vy*s:0,ie=C[this.layer].vx?C[this.layer].vx*s:0;typeof d=="function"&&d.call(p.dragged.parentNode[H],ie,Oe,t,lt,C[this.layer].el)!=="continue"||ar(C[this.layer].el,ie,Oe)}.bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==l&&(h=ce(h,!1)));$t=c}},30),mr=function(e){var n=e.originalEvent,r=e.putSortable,o=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(n){var c=r||i;s();var d=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(d.clientX,d.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:o,putSortable:r}))}};function Yt(){}Yt.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var o=Ce(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),r&&r.animateAll()},drop:mr};te(Yt,{pluginName:"revertOnSpill"});function Ut(){}Ut.prototype={onSpill:function(e){var n=e.dragEl,r=e.putSortable,o=r||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:mr};te(Ut,{pluginName:"removeOnSpill"});p.mount(new pi);p.mount(Ut,Yt);const pr=document.getElementById("bookmarkList"),Vt="##",Gt=`
`,gi=new Ee("#addGroupModal"),qt=t=>{t?([document.getElementById("btnBookmarkEdit"),document.getElementById("btnBookmarkDownload"),document.getElementById("btnBookmarkUpload")].forEach((e,n,r)=>{e.classList.add("d-none")}),[document.getElementById("btnBookmarkGroupAdd"),...document.getElementsByClassName("btnBookmarkGroupEdit"),document.getElementById("btnBookmarkSave"),document.getElementById("btnBookmarkReset"),...document.getElementsByClassName("btnBookmarkReorder"),...document.getElementsByClassName("btnBookmarkRemove")].forEach((e,n,r)=>{e.classList.remove("d-none")})):([document.getElementById("btnBookmarkEdit"),document.getElementById("btnBookmarkDownload"),document.getElementById("btnBookmarkUpload")].forEach((e,n,r)=>{e.classList.remove("d-none")}),[document.getElementById("btnBookmarkGroupAdd"),...document.getElementsByClassName("btnBookmarkGroupEdit"),document.getElementById("btnBookmarkSave"),document.getElementById("btnBookmarkReset"),...document.getElementsByClassName("btnBookmarkReorder"),...document.getElementsByClassName("btnBookmarkRemove")].forEach((e,n,r)=>{e.classList.add("d-none")}))},zt=t=>{document.getElementById("groupNameInput").value.length>0&&(t=document.getElementById("groupNameInput").value,document.getElementById("groupNameInput").value="",gi.hide());const e=z("bookmarkGroup",{"{{name}}":t}),n=z("bookmarkRoute");e.appendChild(n),pr.appendChild(e),new p(n,{handle:".btnBookmarkReorder",group:"route",animation:150})},bi=t=>{t.target.closest("div.list-group-item.group").remove()},gr=(t,e,n=!1)=>{n&&(e=JSON.parse(Gn(e)));let r="",o="";e.company==="mtr_hr"?r=`background-color: ${x("route-hr",e.routeId)}!important;`:e.company==="mtr_lr"&&(r=`--border-color: ${x("route-lr",e.routeId)}; background-color: #fff!important;`,o="mtrLrRoute p-0");const i=z("bookmarkRow",{"{{dataRouteJson}}":Vn(JSON.stringify(e)),"{{href}}":getRouteUrl(e,!0),"{{companyLogo}}":rt(e.company),"{{route}}":e.route,"{{name}}":e.name,"{{routeDesc}}":e.routeDesc,"{{routeCss}}":r,"{{routeClass}}":o});document.querySelectorAll(`div[data-group-name="${t}"] .list-group.route`)[0].appendChild(i),n&&br(),reloadRouter()},Ei=t=>{t.target.closest("div.list-group-item").remove()},vi=()=>{qt(!0)},br=()=>{qt(!1);const t=[...document.getElementsByClassName("group")].map(e=>{const n=e.getAttribute("data-group-name");if(n){const r=[...e.querySelectorAll(".list-group-item")].map(o=>Gn(o.getAttribute("data-route-json"))).join(Vt);return JSON.stringify({[n]:r})}else return null}).filter(e=>!!e).join(Gt);localStorage.setItem("bookmarkList",t)},Xt=()=>{qt(!1),pr.innerHTML="";let t=[];localStorage.hasOwnProperty("bookmarkList")&&(t=localStorage.getItem("bookmarkList").split(Gt).map(e=>{const n=JSON.parse(e);return Object.entries(n).map(r=>({[r[0]]:r[1].split(Vt).map(o=>JSON.parse(o))}))})),t.forEach(e=>{const n=Object.entries(e[0])[0];zt(n[0]),n[1].forEach(r=>gr(n[0],r))})},yi=()=>{let t="";localStorage.hasOwnProperty("bookmarkList")&&(t=localStorage.getItem("bookmarkList"));let e=document.createElement("a"),n=new Blob([t],{type:"text/plain"}),r=URL.createObjectURL(n);e.setAttribute("href",r),e.setAttribute("download","group.txt"),e.click()},_i=t=>{const e=new FileReader;e.onload=n=>{localStorage.setItem("bookmarkList",n.target.result),Xt()},e.onerror=n=>console.error(n),e.readAsText(t.target.files[0])},wi=t=>localStorage.hasOwnProperty("bookmarkList")?localStorage.getItem("bookmarkList").split(Gt).some(e=>{const n=JSON.parse(e);return Object.entries(n).some(r=>r[1].split(Vt).some(o=>{const i=JSON.parse(o);let a=i.company===t.company&&i.routeId===t.routeId&&i.stop===t.stop;switch(t.company){case"kmb":a=a&&i.routeType===t.routeType&&i.dir===t.dir;break;case"ctb":case"nwfb":case"mtr":case"mtr_hr":case"mtr_lr":a=a&&i.dir===t.dir;break;case"gmb":a=a&&i.routeType===t.routeType;break}return a}))}):!1;document.getElementById("btnBookmarkEdit").onclick=vi;document.getElementById("btnBookmarkSave").onclick=br;document.getElementById("btnBookmarkReset").onclick=Xt;document.getElementById("btnBookmarkGroupAddSubmit").onclick=zt;document.getElementById("btnBookmarkDownload").onclick=yi;document.getElementById("fileUploadInput").addEventListener("change",_i,!1);Xt();new p(document.getElementById("bookmarkList"),{handle:".btnBookmarkReorder",group:"group",animation:150});window.addGroup=zt;window.removeGroup=bi;window.addBookmark=gr;window.removeBookmark=Ei;window.isBoomarked=wi;
